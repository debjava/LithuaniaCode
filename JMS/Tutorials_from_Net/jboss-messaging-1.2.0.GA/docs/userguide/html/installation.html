<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;5.&nbsp;JBoss Messaging Non-Clustered Installation</title><link rel="stylesheet" href="css/html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.65.1"><link rel="home" href="index.html" title="JBoss Messaging 1.2 User's Guide"><link rel="up" href="index.html" title="JBoss Messaging 1.2 User's Guide"><link rel="previous" href="gettingstarted.html" title="Chapter&nbsp;4.&nbsp;Download Software"><link rel="next" href="c_installation.html" title="Chapter&nbsp;6.&nbsp;JBoss Messaging Clustered Installation"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;5.&nbsp;JBoss Messaging Non-Clustered Installation</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="gettingstarted.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="c_installation.html">Next</a></td></tr></table><hr></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="installation"></a>Chapter&nbsp;5.&nbsp;JBoss Messaging Non-Clustered Installation</h2></div></div><div></div></div><p>
      This section describes the procedure to perfom a non-clustered installation. At the
      end of this procedure, you will create a JBoss Messaging configuration that will
      start a non-clustered messaging server. To find out how you can install JBoss Messaging
      in a clustered configuration, please proceed to <a href="c_installation.html" title="Chapter&nbsp;6.&nbsp;JBoss Messaging Clustered Installation">Chapter&nbsp;6, <i>JBoss Messaging Clustered Installation</i></a>.
   </p><p>
      By default, a JBoss AS 4.0.x and 4.2.0 instance ships with JBossMQ as default JMS provider.
      In order to use the JBoss AS instance with JBoss Messaging, you need to perform the
      installation procedure described below.
   </p><p>
      </p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3>
         A JBossMQ and a JBoss Messaging instance cannot coexist, at least not unless special
         precautions are taken. Do not simply attempt to copy the Messaging release artifact
         <tt class="filename">jboss-messaging-scoped.sar</tt> over to the JBoss instance
         <tt class="filename">deploy</tt> directory. Follow one of the alternate installation procedures
         outlined below instead.
      </div><p>
   </p><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="install4"></a>5.1.&nbsp;Installing JBoss Messaging with JBoss AS 4.0.x and 4.2.1</h2></div></div><div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>
          You need Apache ant 1.7.0 or newer pre-installed on your system and available in
          you path in order to be able to perform the installation process described below.
      </div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="install4.automated"></a>5.1.1.&nbsp;Installation procedure</h3></div></div><div></div></div><p>
         Set up the <tt class="literal">JBOSS_HOME</tt> environment variable to point to
         the JBoss 4.x installation you want to use JBoss Messaging with. Run the installation
         script, available in the  <tt class="filename">util</tt> directory of the release bundle.
      </p><pre class="programlisting">
cd util
ant -f release-admin.xml
       </pre><p>
            The installation script will create a <tt class="filename">$JBOSS_HOME/server/messaging</tt>
            configuration.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>
          If you want to create a JBoss Messaging configuration with a different name, modify
          the <tt class="literal">messaging.config.name</tt> system property declared at the beginning of
           the installation script accordingly.
       </div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="startingtheservice"></a>5.2.&nbsp;Starting the Server</h2></div></div><div></div></div><p>
        To run the server, execute the <tt class="filename">run.bat</tt> or <tt class="filename">run.sh</tt>
        script as appropriate for your operating system, in the <tt class="filename">$JBOSS_HOME/bin</tt>
        directory.
     </p><pre class="programlisting">
cd $JBOSS_HOME/bin
./run.sh -c messaging
   </pre><p>
        A successful JBoss Messaging deployment generates logging output similar to:
     </p><pre class="programlisting">
....
01:44:48,317 WARN  [JDBCPersistenceManager]

JBoss Messaging Warning: DataSource connection transaction isolation should be
       READ_COMMITTED, but it is currently NONE.
       Using an isolation level less strict than READ_COMMITTED may lead to data
       consistency problems.
       Using an isolation level more strict than READ_COMMITTED may lead to deadlock.

01:44:50,450 INFO  [ServerPeer] JBoss Messaging 1.2.0.GA server [0] started
01:44:51,311 INFO  [ConnectionFactory] Connector bisocket://192.168.1.104:4457 has
leasing enabled, lease period 10000 milliseconds
01:44:51,311 INFO  [ConnectionFactory] [/ConnectionFactory, /XAConnectionFactory,
java:/ConnectionFactory, java:/XAConnectionFactory] started
01:44:51,441 INFO  [ConnectionFactory] Connector bisocket://192.168.1.104:4457 has
leasing enabled, lease period 10000 milliseconds
01:44:51,441 INFO  [ConnectionFactory] [/NonClusteredConnectionFactory,
/NonClusteredXAConnectionFactory, java:/NonClusteredConnectionFactory,
java:/NonClusteredXAConnectionFactory] started
01:44:51,681 INFO  [QueueService] Queue[/queue/DLQ] started, fullSize=200000,
pageSize=2000, downCacheSize=2000
01:44:51,681 INFO  [QueueService] Queue[/queue/ExpiryQueue] started, fullSize=200000,
pageSize=2000, downCacheSize=2000
01:44:51,732 INFO  [TopicService] Topic[/topic/testTopic] started, fullSize=200000,
pageSize=2000, downCacheSize=2000
01:44:51,732 INFO  [TopicService] Topic[/topic/securedTopic] started, fullSize=200000,
pageSize=2000, downCacheSize=2000
01:44:51,732 INFO  [TopicService] Topic[/topic/testDurableTopic] started, fullSize=200000,
pageSize=2000, downCacheSize=2000
01:44:51,752 INFO  [QueueService] Queue[/queue/testQueue] started, fullSize=200000,
pageSize=2000, downCacheSize=2000
01:44:51,752 INFO  [QueueService] Queue[/queue/A] started, fullSize=200000,
pageSize=2000, downCacheSize=2000
01:44:51,762 INFO  [QueueService] Queue[/queue/B] started, fullSize=200000,
pageSize=2000, downCacheSize=2000
01:44:51,762 INFO  [QueueService] Queue[/queue/C] started, fullSize=200000,
pageSize=2000, downCacheSize=2000
01:44:51,882 INFO  [QueueService] Queue[/queue/D] started, fullSize=200000,
pageSize=2000, downCacheSize=2000
01:44:51,882 INFO  [QueueService] Queue[/queue/ex] started, fullSize=200000,
pageSize=2000, downCacheSize=2000
01:44:51,882 INFO  [QueueService] Queue[/queue/PrivateDLQ] started, fullSize=200000,
pageSize=2000, downCacheSize=2000
01:44:51,892 INFO  [QueueService] Queue[/queue/PrivateExpiryQueue] started, fullSize=200000,
pageSize=2000, downCacheSize=2000
01:44:51,892 INFO  [QueueService] Queue[/queue/QueueWithOwnDLQAndExpiryQueue] started,
fullSize=200000, pageSize=2000, downCacheSize=2000
01:44:51,892 INFO  [TopicService] Topic[/topic/TopicWithOwnDLQAndExpiryQueue] started,
fullSize=200000, pageSize=2000, downCacheSize=2000
01:44:51,942 INFO  [QueueService] Queue[/queue/QueueWithOwnRedeliveryDelay] started,
fullSize=200000, pageSize=2000, downCacheSize=2000
01:44:51,942 INFO  [TopicService] Topic[/topic/TopicWithOwnRedeliveryDelay] started,
fullSize=200000, pageSize=2000, downCacheSize=2000
01:44:51,952 INFO  [QueueService] Queue[/queue/testDistributedQueue] started, fullSize=200000,
pageSize=2000, downCacheSize=2000
01:44:51,952 INFO  [TopicService] Topic[/topic/testDistributedTopic] started, fullSize=200000,
pageSize=2000, downCacheSize=2000
01:44:52,372 INFO  [ConnectionFactoryBindingService] Bound ConnectionManager
'jboss.jca:name=JmsXA,service=ConnectionFactoryBinding' to JNDI name 'java:JmsXA'
....
   </pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3>
        The warning message <tt class="literal">DataSource connection transaction isolation should be READ_COMMITTED,
        but it is currently NONE</tt>
        is there to remind you that by default JBossAS ships with Hypersonic, an in-memory
        Java-based database engine, which is apropriate for demo purposes, but not for heavy load
        production environments. The
        <a href="http://wiki.jboss.org/wiki/Wiki.jsp?page=ConfigJBossMQDB" target="_top">Critique of Hypersonic</a>
        wiki page outlines some of the well-known issues occuring when using this database.
     </div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3>
        Before using Messaging in production, you <span class="emphasis"><em>must</em></span> configure
        the Messaging instance to use an enterprise-class database backend such as MySQL or Oracle,
        otherwise you risk losing your data.
        See <a href="configuration.html#conf.changingds" title="8.2.&nbsp;Changing the Database">Section&nbsp;8.2, &#8220;Changing the Database&#8221;</a> for details about replacing Hypersonic.
     </div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="inst.validation"></a>5.3.&nbsp;Installation Validation</h2></div></div><div></div></div><p>
        The release bundle contains a series of examples that should run "out of the box" and
        could be used to validate a new installation. Such an example sends a persistent JMS message
        to a queue called <tt class="literal">queue/testQueue</tt>.
     </p><p>
       To run the example and validate the installation,
       open an new command line window and set the <tt class="literal">JBOSS_HOME</tt>
       environment variable to point to the JBoss AS 4.x installation you've just installed
       Messaging on. Navigate to the folder where
       you extracted the release bundle and drill down to <tt class="filename">/examples/queue</tt>.
       Apache Ant must pe present in your path in order to be able to run the example.
    </p><pre class="programlisting">

setenv JBOSS_HOME=&lt;your_JBoss_installation&gt;
cd .../examples/queue
$ant

   </pre><p>
        A successfull execution log output looks similar to:
     </p><pre class="programlisting">
$ ant
Buildfile: build.xml

identify:
[echo] ###########################################################################
[echo] #                       Running the QUEUE example                         #
[echo] ###########################################################################
[echo] The queue:      testQueue
[echo] The client jar: ../../../output/lib/jboss-messaging-client.jar

sanity-check:

init:
[mkdir] Created dir: c:\work\src\svn\messaging\docs\examples\queue\output
[mkdir] Created dir: c:\work\src\svn\messaging\docs\examples\common\output

compile:
[javac] Compiling 5 source files to c:\work\src\svn\messaging\docs\examples\common\output
[javac] Compiling 1 source file to c:\work\src\svn\messaging\docs\examples\queue\output

run:
   [java] Queue /queue/testQueue exists
   [java] The message was successfully sent to the testQueue queue
   [java] Received message: Hello!
   [java] The example connected to JBoss Messaging version 1.2.0.GA (1.2)
   [java]
   [java] #####################
   [java] ###    SUCCESS!   ###
   [java] #####################

BUILD SUCCESSFUL
Total time: 9 seconds
</pre><p>
        It is recommended to run <tt class="literal">all</tt> validation examples available in the
        <tt class="filename">example</tt> directory (<tt class="filename">queue</tt>,
        <tt class="filename">topic</tt>, <tt class="filename">mdb</tt>, <tt class="filename">stateless</tt>, etc.).
         In <a href="examples.html" title="Chapter&nbsp;7.&nbsp;Running the Examples">Chapter&nbsp;7, <i>Running the Examples</i></a>, we will have a look at each of those examples.
     </p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="gettingstarted.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="index.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="c_installation.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;4.&nbsp;Download Software&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;6.&nbsp;JBoss Messaging Clustered Installation</td></tr></table></div></body></html>